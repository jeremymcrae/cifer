## CIFER: CNV of inheritance from exome read-depth

This package attempts to predict the inheritance state of CNV calls generated by
ConVex. This package compares parental log2-ratio scores within the CNV call to
a model constructed from the log2-ratio scores in a population of unrelated 
trios (specifically, the parents of those trios).

This package determines the parameters of the null model, and estimates the
probability that each parent's log-2 ratio data belongs to the null model. The 
estimated probabilities are used to assign both parents into inheritance 
categories, which are then used to assign an inheritance state for the proband.

### Predicting inheritance:
Using the installed package should involve loading the library and calling the
classification function:
```R
library(cifer)
prediction <- classify_exome_cnv(proband_id, maternal_id, paternal_id, chrom, start_pos, stop_pos)

# access the inheritance prediction
inheritance <- prediction$inheritance
```

The classify_exome_cnv() arguments are:
* proband_id: sample ID for the proband (eg "DDDP100001")
* maternal_id: sample ID for the proband's mother
* paternal_id: sample ID for the proband's father
* chrom: chromosome that the CNV is on (eg "1", "2", ..., "X")
* start_pos: start nucleotide of the CNV as integer
* stop_pos: stop nucleotide of the CNV as integer

Optional arguments are:
* cnv: dataframe of CNV info, not necessary for predicting inheritance, used
    for evaluating CNVs if we plot the population distribution.
* DATAFREEZE_DIR: path to folder containing files listing study samples, and
    their relationships.

The code is available at: https://github.com/jeremymcrae/cifer, and can be 
obtained with: `git clone https://github.com/jeremymcrae/cifer.git`

### Building the CIFER package:
Change to the cifer directory, and start R.

Load devtools and roxygen (requires R >= 3.0.1), then build a cifer.tar.gz 
package, which can be installed locally.
```R
library(devtools)
library(roxygen)

# construct the package documentation
document()

# check the package contents are correct (which should complete without errors, 
# aside from a note about a non-standard python directory). This also runs the
# unit tests found in the tests folder, which should complete without error.
check()

# Finally, build the package:
build()

# optionally install the package from source, rather than from the built package
install()
```
